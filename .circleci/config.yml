version: 2
jobs:
  build_and_test:
    docker:
      - image: mickare/cmake-clang
    steps:
      - checkout
      - run: clang -coverage -O0 tst/test.c tst/test.h src/array.c src/array.h tst/array.c src/vector.c src/vector.h tst/vector.c src/deque.c src/deque.h tst/deque.c src/forward_list.c src/forward_list.h tst/forward_list.c src/list.c src/list.h tst/list.c src/set.c src/set.h tst/set.c src/map.c src/map.h tst/map.c src/multiset.c src/multiset.h tst/multiset.c src/multimap.c src/multimap.h tst/multimap.c src/unordered_set.c src/unordered_set.h tst/unordered_set.c src/unordered_map.c src/unordered_map.h tst/unordered_map.c src/unordered_multiset.c src/unordered_multiset.h tst/unordered_multiset.c src/unordered_multimap.c src/unordered_multimap.h tst/unordered_multimap.c src/stack.c src/stack.h tst/stack.c src/queue.c src/queue.h tst/queue.c src/priority_queue.c src/priority_queue.h tst/priority_queue.c
      - run: ./a.out
      - run: gcov array.c vector.c deque.c forward_list.c list.c set.c map.c multiset.c multimap.c unordered_set.c unordered_map.c unordered_multiset.c unordered_multimap.c stack.c queue.c priority_queue.c
      - run: bash <(curl -s https://codecov.io/bash)
workflows:
  version: 2
  build_and_test:
    jobs:
      - build_and_test

